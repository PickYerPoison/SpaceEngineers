int frame = 0;
double counter = 0;

double FRAMES_PER_SECOND = 10;
int TICKS_PER_SECOND = 60;
double DELAY = 1;

Animation AnimIdle, AnimFly, AnimSit;

enum Animations
{
    IDLE = 0,
    FLY,
    SIT
}

Animations currentAnimation = Animations.IDLE; 

public Program() 
{ 
    // begin update frequency 
    Runtime.UpdateFrequency = UpdateFrequency.Update1;
    
    InitAnimations();
} 
 
public void Main(string argument, UpdateType updateType) 
{
    if ((updateType & (UpdateType.Script | UpdateType.Terminal)) != 0)
    {
        Animations newAnimation = currentAnimation;
        switch (argument.ToLower())
        {
            case "idle": newAnimation = Animations.IDLE; break;
            case "fly": newAnimation = Animations.FLY; break;
            case "sit": newAnimation = Animations.SIT; break;
            case "reset": frame = 0; break;
            default: break;
        }
        
        if (newAnimation != currentAnimation)
        {
            currentAnimation = newAnimation;
            frame = 0;
        }
    }
    else if ((updateType & UpdateType.Update1) != 0)
    {
        DELAY = FRAMES_PER_SECOND / TICKS_PER_SECOND;
        
        if (counter >= 1)
        {
            // retrieve LCDs
            var LCDs = new List<IMyTextPanel>(); 
            GridTerminalSystem.GetBlocksOfType<IMyTextPanel>(LCDs, (IMyTextPanel x) => x.CustomData.Contains("animation"));
            
            Animation animRef = new Animation();
            bool loop = true;
            FRAMES_PER_SECOND = 10;
            
            switch (currentAnimation)
            {
                case Animations.IDLE:
                    animRef = AnimIdle;
                    FRAMES_PER_SECOND = 2;
                    break;
                case Animations.FLY:
                    animRef = AnimFly;
                    break;
                case Animations.SIT:
                    animRef = AnimSit;
                    loop = false;
                    break;
            }
            
            if (frame >= animRef.Count())
            {
                if (loop == false)
                {
                    frame = animRef.Count() - 1;
                }
                else
                {
                    frame = 0;
                }
            }
            
            foreach (var LCD in LCDs)
            {
                LCD.Font = "Monospace";
                LCD.FontSize = 0.278125f;
                LCD.ShowPublicTextOnScreen();
                LCD.WritePublicText(animRef.GetFrame(frame)); 
            }
            
            frame++;
            
            counter = 0;
        }
        counter += DELAY;
    }
}

class Animation
{
    List<string> m_frames;
    
    public Animation()
    {
        m_frames = new List<string>();
    }
    
    public Animation(string[] frames)
    {
        m_frames = new List<string>(frames);
    }
    
    public int Count()
    {
        return m_frames.Count();
    }
    
    public string GetFrame(int frame)
    {
        string frameToReturn = "";
        if (m_frames.Count() > 0)
        {
            frameToReturn = m_frames[frame % m_frames.Count()];
        }
        
        return frameToReturn;
    }
}

void InitAnimations()
{
    string[] idleAnimation = {
@"






























































",

@"






























































"
    };
    AnimIdle = new Animation(idleAnimation);
    
    string[] flyAnimation = {
@"






























































",

@"






























































",

@"






























































"
    };
    AnimFly = new Animation(flyAnimation);
    
    string[] sitAnimation = {
@"






























































",

@"






























































",

@"






























































",

@"






























































",

@"






























































",

@"






























































",

@"






























































",

@"






























































",

@"






























































",

@"






























































",

@"






























































",

@"






























































",

@"






























































",

@"






























































",

@"






























































"
};
    AnimSit = new Animation(sitAnimation);
}